{{/*
  Build language switch links:
  - Prefer current page translation if it exists
  - Fallback to language homepage
*/}}
{{ $cur := . }}
{{ $homeLinks := dict }}
{{ range site.Home.AllTranslations }}
  {{ $homeLinks = merge $homeLinks (dict .Lang .RelPermalink) }}
{{ end }}
{{ $homeLinks = merge $homeLinks (dict site.Home.Lang site.Home.RelPermalink) }}

<header class="site-header">
  <div class="header-inner">


    <a class="brand brand-stack brand-image" href="{{ "/" | relLangURL }}" aria-label="Accountia">
      
      <img class="brand-img" src="{{ "images/accountia_logo_horizontal.png" | relURL }}" alt="Accountia Regnskap">

    </a>


    <!-- Mobil meny-toggle -->
    <input class="nav-toggle" type="checkbox" id="nav-toggle" aria-label="{{ i18n "open_menu" }}">

    <label class="nav-toggle-btn" for="nav-toggle">
      <span></span>
      <span></span>
      <span></span>
      <span class="menu-text">{{ i18n "menu" }}</span>
    </label>

    <nav class="nav" role="navigation">
      {{/*
        RTL (Arabic) desired behavior:
        - Language selector on the far right
        - Then Forside, Tjenester, Om oss, Kontakt, Personvern, Priser (reading right-to-left)
        Achieve this by rendering the language dropdown first for Arabic,
        and keeping menu items in their natural order.
      */}}

      {{/* Language dropdown: go to the same page in the chosen language when possible */}}
      {{ $cur := . }}
      {{ $home := site.Home }}
      {{ $homeLinks := dict }}
      {{ range $home.AllTranslations }}
        {{ $homeLinks = merge $homeLinks (dict .Lang .RelPermalink) }}
      {{ end }}
      {{ $homeLinks = merge $homeLinks (dict $home.Lang $home.RelPermalink) }}

      {{/* Pretty, native language names in the dropdown */}}
      {{ $langNames := dict "no" "Norsk" "en" "English" "es" "Español" "ar" "العربية" }}

      {{/* Language dropdown component */}}
      {{ $langDropdown := partial "lang-dropdown.html" . }}

      {{ if eq site.Language.Lang "ar" }}
        {{ $langDropdown | safeHTML }}
        {{ range site.Menus.main }}
          <a class="nav-link {{ if $.IsMenuCurrent "main" . }}active{{ end }}" href="{{ .URL }}">{{ .Name }}</a>
        {{ end }}
      {{ else }}
        {{ range site.Menus.main }}
          <a class="nav-link {{ if $.IsMenuCurrent "main" . }}active{{ end }}" href="{{ .URL }}">{{ .Name }}</a>
        {{ end }}
        {{ $langDropdown | safeHTML }}
      {{ end }}
    </nav>
  </div>
</header>
